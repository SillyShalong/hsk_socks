TODO:
1. deal with nonblock connect()
2. support ipv6